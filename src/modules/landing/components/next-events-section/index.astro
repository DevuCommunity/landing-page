---
import Title from "../../components/title/index.astro"
import SocialNetwork from "../hero/social-network.astro"
import { getNearestEvent, getUpcomingEvents } from "../../../events/helpers/index.js"

const typeToLabel = {
  physical: "Presencial",
  virtual: "Virtual",
  hybrid: "Híbrido",
}

const nearestEvent = getNearestEvent()
const upcomingEvents = getUpcomingEvents(nearestEvent)
---

<Title>Eventos</Title>

<div
  style="
    color: var(--gray-color);
    border: 2px solid var(--clear-gray);
    border-style: dashed;
    border-width: .5cap;
  "
  class="
    Inter
    md:p-8
    rounded-lg
    text-center
    bg-gradient-to-l
    from-white/20
  ">
  <div class="">
    {
      !nearestEvent ? (
        <div class="flex flex-col items-center">
          <p class="text-lg">No hay eventos próximos por el momento, pero puedes seguirnos en nuestras redes sociales para mantenerte al día</p>
          <SocialNetwork />
        </div>
      )
      : (
        <article class="p-4 md:p-8 text-white text-center flex flex-col items-center">
          <h3 class="Fredoka mb-4" style="color: var(--yellow-duck);">{nearestEvent.name}</h3>
          {
            nearestEvent.invitationVideos.length
              ? <div class="text-center w-full">
                  <div class="aspect-video" set:html={nearestEvent?.invitationVideos?.[0]?.iframe} />
                </div>
              : <div></div>
          }

          <p class="text-lg max-w-[900px]" set:html={nearestEvent.description} />
          <p>Fecha: {nearestEvent.dateLabel}</p>
          { nearestEvent.timeLabel ? <p>Hora: {nearestEvent.timeLabel}</p> : <div></div>}
          <p>Tipo de evento: {typeToLabel[nearestEvent.participationType]}</p>
          {
            nearestEvent.participationType === "physical"
              && <p>Lugar: {nearestEvent.place.name} - {nearestEvent.place.address}</p>
          }
          {
            nearestEvent.participationType === "virtual"
              && <p>Plataforma: {nearestEvent.platform.name}</p>
          }
          {
            nearestEvent.participationType === "hybrid"
              && (
                <p style="color: var(--yellow-duck)">
                  Lugar: {nearestEvent.place.name} - {nearestEvent.place.address}
                  <br />
                  Plataforma: {nearestEvent.platform.name}
                </p>
              )
          }
          {
            nearestEvent.officialEventUrl
              ? (
                <a
                target="_blank"
                rel="noopener noreferrer"
                class="button-ghost-pink mt-8 w-full md:w-fit"
                href={nearestEvent.officialEventUrl}>
                {nearestEvent.callToAction}
              </a>
              )
              : <p class="text-lg button-ghost-pink mt-8 w-full md:w-fit !cursor-default">Pronto más información</p>
          }
          {
            !nearestEvent.invitationVideos.length
              ? <div></div>
              // we will support 1 video for now, but we can support more in the future
              : (
                <div class=" w-full">
                  {
                    nearestEvent.invitationVideos.map(video => (
                      <div></div>
                    ))
                  }
                </div>
              )
          }
        </article>
      )
    }
  </div>
</div>

<div class="grid grid-cols-1 md:grid-cols-1 gap-16 mt-8">
  {
    upcomingEvents.map(event => (
      <div
        class="
          Inter
          p-8
          rounded-lg
          bg-gradient-to-l
          from-white/20
          text-white
          text-center
          flex
          flex-col
          items-center
          border-[var(--clear-gray)]
          border-2
        ">
        <h3>{event.name}</h3>
        <p class="max-w-[700px]" set:html={event.description}></p>
        <p>Tipo: {typeToLabel[event.participationType]}</p>
        <p>Fecha: {event.dateLabel}</p>
        { nearestEvent.timeLabel ? <p>Hora: {nearestEvent.timeLabel}</p> : <div></div>}
        <p>Plataforma: {event.platform ? event.platform.name : event.place.name}</p>
        {
          event.officialEventUrl
            ? <a
                target="_blank"
                rel="noopener noreferrer"
                class="button-ghost-pink mt-8 w-full md:w-fit"
                href={event.officialEventUrl}>
                {event.callToAction}
              </a>
            : <p class="text-lg button-ghost-pink mt-8 w-full md:w-fit !cursor-default">Pronto más información</p>
        }
      </div>
    ))
  }
</div>
